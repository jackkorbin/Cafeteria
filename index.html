<!DOCTYPE html>

<html class="no-js">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Cafeteria</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/custom.css">


    
        <style>
          body{
/*            background-color:#22313F;*/
              background:#8ec1da url(img/food2.jpg) no-repeat center center fixed;
            -webkit-background-size: cover;
            -moz-background-size: cover;
            -o-background-size: cover;
            background-size: cover;
            font-weight:normal;
            
          }
      </style>
    
</head>
<body>

    <div class="custom">
        
        
        
        <div class="main-box">
            <div class="overlay">
                
                <span class="btn btn-success topbuttons pull-left" id="clear">
                    <span class="glyphicon glyphicon-chevron-left"></span>
                    <g>Clear All</g>
                </span>
                <span class="title">
                    <span>Cafetaria</span>
                </span>
                <span class="btn btn-danger topbuttons pull-right" id="btn-history">
                    
                    <g>History</g>
                    <span class="glyphicon glyphicon-chevron-right"></span>
                </span>
                
                
            </div>
            

<!--
            <ul class="nav nav-tabs nav-justified tab-ul" >
              <li class="active"><a class="" href="#menu" data-toggle="tab">Menu</a></li>
              <li class=""><a class="" href="#randomfood" data-toggle="tab">Random</a></li>
            </ul>
-->


<!--
            <ul class="nav navbar-nav custom-tab-ul hidden-xs" id="myTab">
                <li class="custom-list active"><a href="#menu" data-toggle="tab" class=""><i class="glyphicon glyphicon-heart"></i><span>Cafe Menu</span></a></li>
                <li class="custom-list"><a href="#randomfood" data-toggle="tab" class=""><i class="glyphicon glyphicon-fire"></i><span>Selected Food</span></a></li>
            </ul>
-->
            
<!--
            <ul class="nav navbar-nav custom-tab-ul" id="myTab">
                <li class="custom-list active"><a href="#menu" data-toggle="tab" class=""><i class="glyphicon glyphicon-heart"></i><span>Menu</span></a></li>
                <li class="custom-list"><a href="#randomfood" data-toggle="tab" class=""><i class="glyphicon glyphicon-fire"></i><span>Selected</span></a></li>
            </ul>
-->


            
             <div class="tab-content settings">
                
                <div class="fade in tab-pane active" id="menu"><!-- Tab 1 -->
                    
                    <div class="main-content menu">
                        <div class="inputs-menu">
                            <input type="text" class="form-control" id="name-menu" placeholder="Type Food item..">
                            <input type="text" class="form-control" id="budget-menu" placeholder="Your budget?">
                        </div>
                        
                        <div class="btn btn-danger bottom-tab-button-back" id="showselecteditems">

                            <span class="" id="">Show Only Selected Items</span>
                        </div>
                        
                        <div class="loading-cont">
                            <div class="loading">
                                <span class="glyphicon glyphicon-refresh spin"></span>
                            </div>
                        </div>
                        
                        
                        <div class="selected-box-cont">
                            
                            <div class="selected-box">
                                
                                <div id="what">
<!--
                                    <div class="fooditem no-margin">
                                        <span class="name" id="name">
                                            Rajma chawal
                                        </span>
                                        <span class="">
                                             x 4 
                                        </span>
                                        <span class="cost" id="cost">
                                            78 Rs
                                        </span>
                                    </div>
-->
                                    No Items Selected!
                                </div>
                                
                                
                                <div class="btn btn-danger bottom-tab-button-back back">
                                    <span class="glyphicon glyphicon-chevron-left"></span>
                                    Back
                                </div>
                                <div class="btn btn-success bottom-tab-button-back save" id="savehistory">
                                    <span class="glyphicon glyphicon-check"></span>
                                    Save
                                </div>
                                
                            
                            </div> 
                        </div>
                        
                        <div id="show-menu">                 
<!--
                            <div class="fooditem">
                                <span class="name" id="name">
                                    Rajma chawal
                                </span>
                                <select class="quan form-control" id="quan"><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option></select>
                                <span class="cost" id="cost">
                                    78
                                </span>
                            </div>
--> 
                            <i class="glyphicon glyphicon-refresh spin"></i>
                        </div>
                        
<!--                        HISTORY TAB-->
                        
                        <div class="history-box-cont">
                            <div class="history-box">
                                
                                <div class="overlay overlay-his">
                                    <span> History </span>
                                </div>
                                
                                <div id="history">
                                    
<!--
                                    <div class="onedate">
                                        
                                        <div class="fooditem fooditem-date">
                                            <span class="name" id="name">
                                                2nd june 2014
                                            </span>
                                            <span class="cost" id="cost">
                                                282 Rs
                                            </span>
                                            <span class="glyphicon glyphicon-chevron-down"></span>
                                        </div>
                                        
                                        <div class="fooditem-subs-cont">
                                            <div class="fooditem-subs">
                                                <span class="name">
                                                    Rajma Chawal x 1
                                                </span>
                                                <span class="cost">
                                                    76 Rs
                                                </span>
                                            </div>
                                            <div class="fooditem-subs">
                                                <span class="subs-name">
                                                    Cheese pizza x 4
                                                </span>
                                                <span class="cost">
                                                    206 Rs
                                                </span>
                                            </div>
                                        </div>
                                        
                                    </div>
-->
                                    <div class="onedate">
                                        Local storage dont support in your browser
                                    </div>
                                    
                                    
                                    
                                    <div class="fooditem total-css">
                                        <span class="name" id="name">
                                            Total
                                        </span>
                                        <span class="cost" id="cost">
                                            420 Rs
                                        </span>
                                    </div>
                                    

                                </div>
                                
                                
                                
                                <div class="btn btn-warning bottom-tab-button-back back" id="hidehistorytab">
                                    <span class="glyphicon glyphicon-home"></span>
                                    Back
                                </div>
                                <div class="btn btn-danger bottom-tab-button-back save" id="clearhistory">
                                    <span class="glyphicon glyphicon-trash"></span>
                                    Clear History
                                </div>
                                
                                
                                
                            
                            </div> 
                        </div>
                        
                        
                        
                    </div>
                </div> <!-- End of tab 1 -->
            

<!--
                <div class="fade in tab-pane" id="randomfood">
                    <div class="main-content">
                        
                        <input type="text" class="form-control" id="budget" placeholder="Enter Budget">
                        
                        <div id="show">
                        </div>
                        
                    </div>
                
                    <button class="btn generatebtn" id="random">Generate Food</button>
                   
                </div> 
-->

                 
                
                 
                
            
        
        </div>

        
<!--
        <div class="footer">
            Created by <span>Jack korbin</span>
        </div>
-->
            
        <div id="totalcost" class="total-cost">
<!--
            <div class="clear bottom-tab-button">
                Clear all
            </div>
            <div class="total bottom-tab-button">
                Total 0 Rs.
            </div>
            <div class="confirm bottom-tab-button">
                Confirm
            </div>
-->
            
<!--
            <div class="total bottom-tab-button">
                Total 0 Rs.
            </div>
-->
            <div class="btn btn-danger bottom-tab-button-back" id="confirm">
                
<!--
                <span class="btn btn-info topbuttons pull-left" id="">
                    <span class="glyphicon glyphicon-chevron-left"></span>
                    <g>Show Selected</g>
                </span>
-->
                
                <span>Total</span>
                <span class="" id="total">0</span>
                <span> Rs. </span>
                
                <span class="" id="confirm-text">Click to Confirm</span>
            </div>
            
            
        </div>
            
        
    </div>
        
        
        
    </div>   
    
    
<script src="js/vendor/jquery-1.11.0.min.js"></script>
<script src="js/vendor/bootstrap.min.js"></script>
<script src="menu.json"></script>
<script src="js/click.js"></script>
<script src="js/history.js"></script>
<script>
    
var showmenuheight = parseInt($(document).innerHeight() - 180);

    
$(document).ready(function(){
    
    $('#myTab a').click(function () {
      $(this).tab('show');
    });
    
    fetchmenu();
    
    $('#name-menu, #budget-menu').keyup(sortmenu);
    
    
    
});
    
$(window).load(function(){
    clearall();
});
    
//HISTORY TAB -->
var historytab = 0;
    
function showhistorytab(){
    
    $('.history-box-cont').show(200);
    historytab = 1;
    $('#clear g').html('Home');
    
}
function hidehistorytab(){
    
    $('.history-box-cont').hide(200);
    historytab = 0;
    $('#clear g').html('Clear All');
}

//updatehistory();
  
function coverttotime(t){
    var mode = "am";
    te = t.split(':');
    if( te[0] > 12 ){
        te[0] = te[0] - 12;
        mode = "pm";
    }
    var time = te[0]+':'+te[1]+' '+mode;
    return time;
} 
    
//var booleanconfirm = 0; // HAS TO BE 1 for confirm to work;
    
    
/// UPDATE TOTAL : -->
    
$(document).on("change", ".quan", function() {
    foods = $('#show-menu div .name');
    quantity = $('#show-menu div .quan');
    costs = $('#show-menu div .cost');
    
    var total = 0;
    var texts = '';
    
    for (var i=0; i < foods.length; i++) {
        if (parseInt(quantity[i].value) > 0) {
            costi = parseInt(costs[i].innerHTML);
            
            texts += '<div class="fooditem no-margin"><span class="name" id="name">'+foods[i].innerHTML+'</span><span class=""> x '+parseInt(quantity[i].value)+' </span><span class="cost" id="cost"> '+ (costi * parseInt(quantity[i].value)) +' Rs</span></div>';
            
            total += (costi * parseInt(quantity[i].value)); 
            
            var repeat = false;
            
            for(var j=0; j<arrayofselecteditems.length; j++){
                
                if( foods[i].innerHTML == arrayofselecteditems[j].name  ){
                    repeat = true;
                    if( parseInt(quantity[i].value) == arrayofselecteditems[j].quantity ){
                        break;
                    }
                    else{
                        arrayofselecteditems[j].quantity = parseInt(quantity[i].value);
                        break;
                    }
                }
                
            }
            
            if( repeat == false  ){
                    update_arrayofselecteditems(foods[i].innerHTML,parseInt(quantity[i].value),costi * parseInt(quantity[i].value));

            }
    
        }
        else {
            for(var j=0; j<arrayofselecteditems.length; j++){
                
                if( foods[i].innerHTML == arrayofselecteditems[j].name  ){
                    arrayofselecteditems.splice(j,1);
                    break;
                }
                
            }
        }
        
        if( parseInt(quantity[i].value) == 0 ){
            $('#fooditem'+i+' .quan').css({'border-bottom':'2px solid #81CFE0'});
        }
        else{
            $('#fooditem'+i+' .quan').css({'border-bottom':'2px solid #D91E18'});
        }
         
    }
    
    //texts += "TOTAL : Rs. " + total;
//    if( total > 0 ){
//        booleanconfirm = 1;
//    }
//    else{
//        booleanconfirm = 0;
//    }
    
    $('#total').html(total);
    

    if( texts == '' ){
        texts = '<div class="fooditem no-margin"><span class="name" id="name">Please Select Some Food Items By clicking on the Right of the Food item!</span></div>';
    }
    
    $('#what').html(texts);
    $('#what').append('<div class="fooditem total-css"><span class="name" id="name">Total</span><span class="cost" id="cost">'+total+' Rs</span></div>');
    
});
    

    
    
$(window).resize(function() { 
    responsiveness(); 
});   
    

    
    
function responsiveness(){
    showmenuheight = parseInt($(document).innerHeight() - 180);
    $('#show-menu').css('height',showmenuheight-50+'px');
    $('.selected-box').css('height',showmenuheight + 56+'px');
    $('.loading').css('height',showmenuheight + 56+'px');
    $('.history-box').css('height',showmenuheight + 59 +56+'px');
    $('#history').css('height',showmenuheight + -30 +'px');
    $('#history').scrollTop($('#history')[0].scrollHeight);
    
    if( $(window).width() < 400  ){
        $('.title').css({'display':'none'});
        $('#name-menu').attr("placeholder", "Type Food!");
        $('#budget-menu').attr("placeholder", "Enter Budget");
    }
    
}
    
function showselected(){
    
    $('.loading-cont').show();
    
    setTimeout(function(){
        $('.loading-cont').hide();
        $('.selected-box-cont').show();
    },400);
    
    $('#confirm-text').html('Back');
    
    
    togglebool = 0;
}
function hideselected(){
  
    $('.selected-box-cont').hide();
    $('.loading-cont').hide();

    $('#confirm-text').html('Click to Confirm');
    togglebool = 1;
    
}
function clearall(){
    
    showallitems();
    showselitems = 0;
    $('#showselecteditems span').html('Show Only Selected Items');
    
    
    fetchmenu();
    $('#what').html('<div class="fooditem no-margin"><span class="name" id="name">Please Select Some Food Items By clicking on the Right of the Food item!</span></div>');
    $('#total').html(0);
    hideselected();
    arrayofselecteditems = [];
    booleanconfirm = 0;
    $('#budget-menu').val('');
    $('#name-menu').val('');
}
    
    
//FETCH AND SORT MENU -->

function sortmenu(){
    
    var name = ($('#name-menu').val()).toLowerCase();
    var budget = $('#budget-menu').val();
    
    showallitems();
    showselitems = 0;
    $('#showselecteditems span').html('Show Only Selected Items');
    
    
    $('.category').css({'display':'none'});
    
    for( var i=0; i<menu.length;i++ ){
        $('#fooditem'+i).css({'display':'none'});
        
        var id = menu[i].category.replace(/ /g,'');
        
        
        if( (menu[i].cost <= budget || budget == '') && ( (menu[i].name.toLowerCase()).indexOf(name) != -1 || name == '' ) ){
            //text += '<div class="fooditem"><span class="name">'+menu[i].name+'</span><span class="cost">'+menu[i].cost+' Rs</span></div>';
            $('#fooditem'+i).css({'display':'block'});
            
            $('#'+id).css({'display':'block'});

        }
    }
    
}
 
var categorycolors = ['#F89406','#F64747','#00B16A','#674172','#DB0A5B'];
    
function fetchmenu(){
    
    var category = '';
    var text = '';
    
    
    for( i=0; i < menu.length; i++ ){
        //$('<style>').text('.color{ background-color:'+categorycolors[ i%categorycolors.length ]+';}').appendTo("head");
        if( menu[i].category != category ){
            category = menu[i].category;
            var id = menu[i].category.replace(/ /g,'');
            text += '<div class="category" id="'+id+'"><span>'+category+'</span></div>';
        }
        
        
        
        if( category == menu[i].category ){
            
            text += '<div class="fooditem" id="fooditem'+i+'"><i id="reset'+i+'" class="reset glyphicon glyphicon-remove-circle"></i><span class="name" id="name">' + menu[i].name + '</span>' +  options(i) + '<span class="cost" id="cost">'+ menu[i].cost +' Rs. </span></div>';
        }
        
        
    }
    
    
    var j = $('.main-content').width();
    //$('.selected-box').css('left','calc( 50% - '+ j/2 +'px )');
    
    
    $('#show-menu').html(text);
    
    responsiveness();
    
    $('#show-menu').show(500);
    
    changecategorycolor();
    
    
}
   

function showselecteditems(){
    var quantity = $('#show-menu .quan');
    $('.category').css({'display':'none'});
    
    for( var i = 0; i < quantity.length; i++ ){
        if (parseInt(quantity[i].value) == 0) {
            $('#fooditem'+i).hide();
            
        }
        else{
            var id = menu[i].category.replace(/ /g,'');
            $('#'+id).css({'display':'block'});
        }
    }
}
    
function showallitems(){
    $('.category').show();
    $('.fooditem').show();
}

    
function changecategorycolor(){
    
    
    for(var i=0; i<menu.length ; i++){
        var j = Math.ceil( 500*Math.random() ) % categorycolors.length;
        
        var id = menu[i].category.replace(/ /g,'');
        $('#'+id).css('background-color',categorycolors[ j ]);
        
    }
    
}

function options(i) {
    return '<select class="quan" id="quan'+i+'"><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option></select>';
}
    
    
    
    
////RANDOM GENERATOR FUNCTIONS --> 
//    
//$('#random').click(function(){
//    
//    $('.generatebtn').html('<i class="glyphicon glyphicon-refresh spin"></i>');
//
//    setTimeout(function(){
//        valuechecker();
//    },500);
//    
//    
//});
//    
//    
//function valuechecker(){
//    if( isNaN($('#budget').val()) ){
//        $('#show').html('<div class="error">Enter a Valid input or Get Lost.</div>');
//        $('.generatebtn').html('Generate Random');
//    }
//    else if( $('#budget').val() < 4 ){
//        $('#show').html('<div class="error">You should probably go to mess.</div>');
//        $('.generatebtn').html('Generate Random');
//    }
//    else if( $('#budget').val() < 50 ){
//        selectrandomfood(1);
//    }
//    else if( $('#budget').val() < 120 ){
//        selectrandomfood(2);
//    }
//    else if( $('#budget').val() < 200 ){
//        selectrandomfood(3);
//    }
//    else{
//        selectrandomfood(4);
//    }
//}
//    
//    
//    
//function selectrandomfood(n){
//    $('#show').html('');
//    var budget = $('#budget').val();
//    
//    var total = 0;
//    var text = '';
//    var happnd = [];
//    
//    for( var i = 0 ; i < n; i++){
//        
//        var j = Math.floor(Math.random() * menu.length);
//        
//        if( happnd.indexOf(j) != -1 || menu[j].category == 'Cakes/Pastry' || menu[j].category == 'Ice Cream' ){
//            i--;
//            continue;
//        }
//        happnd.push(j);
//        text = text+'<div class="fooditem"><span class="name">'+menu[j].name+'</span><span class="cost">'+menu[j].cost+' Rs</span></div>';
//       
//        total += menu[j].cost;
//    }
//    if( total > budget  ){
//
//        $('#show').html('');
//        selectrandomfood(n);
//        return 0;
//    }
//    else{
//        
//        if( budget < 250 && total < budget/2 && budget > 50 ){
//            console.log('here');
//            $('#show').html('');
//            selectrandomfood(n);
//            return 0;
//        }
//        else{
//            $('#show').hide(200);
//            $('#show').append(text);
//            $('#show').append('<div class="fooditem"><span class="name">Total</span><span class="cost">'+total+' Rs</span></div>');
//            $('#show').show(200);
//            $('.generatebtn').html('Generate Again');
//        }
//    }
//}

    

    
    
    
    
</script>
        
</body>
</html>
